"use strict";(self.webpackChunkZmitaCart=self.webpackChunkZmitaCart||[]).push([[919],{4919:(F,_,l)=>{l.r(_),l.d(_,{LoginComponent:()=>B});var O=l(4755),u=l(9401),R=l(5402),k=l(2950),I=l(430),y=l(5525),p=l(3431),g=l(5995),m=l(7579),f=l(9300),D=l(8505),v=l(2722),E=l(6012),P=l(5861),o=l(2223),w=l(1135),S=l(4707);class U extends m.x{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(a){const{hasError:e,_hasValue:t,_value:i,thrownError:s,isStopped:r,_isComplete:c}=this;e?a.error(s):(r||c)&&(t&&a.next(i),a.complete())}next(a){this.isStopped||(this._value=a,this._hasValue=!0)}complete(){const{_hasValue:a,_value:e,_isComplete:t}=this;t||(this._isComplete=!0,a&&super.next(e),super.complete())}}var x=l(5191),T=l(5684),M=l(5698);class C{constructor(){}loadScript(a,e,t,i=null){if(typeof document<"u"&&!document.getElementById(a)){let s=document.createElement("script");s.async=!0,s.src=e,s.onload=t,i||(i=document.head),i.appendChild(s)}}}class N{}const A={oneTapEnabled:!0};let d=(()=>{class n extends C{constructor(e,t){super(),this.clientId=e,this.initOptions=t,this.changeUser=new o.vpe,this._socialUser=new w.X(null),this._accessToken=new w.X(null),this._receivedAccessToken=new o.vpe,this.initOptions={...A,...this.initOptions},this._socialUser.pipe((0,T.T)(1)).subscribe(this.changeUser),this._accessToken.pipe((0,T.T)(1)).subscribe(this._receivedAccessToken)}initialize(e){return new Promise((t,i)=>{try{this.loadScript(n.PROVIDER_ID,"https://accounts.google.com/gsi/client",()=>{if(google.accounts.id.initialize({client_id:this.clientId,auto_select:e,callback:({credential:s})=>{const r=this.createSocialUser(s);this._socialUser.next(r)},prompt_parent_id:this.initOptions?.prompt_parent_id,itp_support:this.initOptions.oneTapEnabled}),this.initOptions.oneTapEnabled&&this._socialUser.pipe((0,f.h)(s=>null===s)).subscribe(()=>google.accounts.id.prompt(console.debug)),this.initOptions.scopes){const s=this.initOptions.scopes instanceof Array?this.initOptions.scopes.filter(r=>r).join(" "):this.initOptions.scopes;this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:s,prompt:this.initOptions.prompt,callback:r=>{r.error?this._accessToken.error({code:r.error,description:r.error_description,uri:r.error_uri}):this._accessToken.next(r.access_token)}})}t()})}catch(s){i(s)}})}getLoginStatus(){return new Promise((e,t)=>{this._socialUser.value?e(this._socialUser.value):t(`No user is currently logged in with ${n.PROVIDER_ID}`)})}refreshToken(){return new Promise((e,t)=>{google.accounts.id.revoke(this._socialUser.value.id,i=>{i.error?t(i.error):e(this._socialUser.value)})})}getAccessToken(){return new Promise((e,t)=>{this._tokenClient?(this._tokenClient.requestAccessToken({hint:this._socialUser.value?.email}),this._receivedAccessToken.pipe((0,M.q)(1)).subscribe(e)):t(this._socialUser.value?"No token client was instantiated, you should specify some scopes.":"You should be logged-in first.")})}revokeAccessToken(){return new Promise((e,t)=>{this._tokenClient?this._accessToken.value?google.accounts.oauth2.revoke(this._accessToken.value,()=>{this._accessToken.next(null),e()}):t("No access token to revoke"):t("No token client was instantiated, you should specify some scopes.")})}signIn(){return Promise.reject('You should not call this method directly for Google, use "<asl-google-signin-button>" wrapper or generate the button yourself with "google.accounts.id.renderButton()" (https://developers.google.com/identity/gsi/web/guides/display-button#javascript)')}signOut(){var e=this;return(0,P.Z)(function*(){google.accounts.id.disableAutoSelect(),e._socialUser.next(null)})()}createSocialUser(e){const t=new N;t.idToken=e;const i=this.decodeJwt(e);return t.id=i.sub,t.name=i.name,t.email=i.email,t.photoUrl=i.picture,t.firstName=i.given_name,t.lastName=i.family_name,t}decodeJwt(e){const i=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(window.atob(i).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(s)}}return n.PROVIDER_ID="GOOGLE",n})(),b=(()=>{class n{get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}constructor(e,t,i){this._ngZone=t,this._injector=i,this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new S.t(1),this.initialized=!1,this._initState=new U,e instanceof Promise?e.then(s=>{this.initialize(s)}):this.initialize(e)}initialize(e){this.autoLogin=void 0!==e.autoLogin&&e.autoLogin;const{onError:t=console.error}=e;e.providers.forEach(i=>{this.providers.set(i.id,"prototype"in i.provider?this._injector.get(i.provider):i.provider)}),Promise.all(Array.from(this.providers.values()).map(i=>i.initialize(this.autoLogin))).then(()=>{if(this.autoLogin){const i=[];let s=!1;this.providers.forEach((r,c)=>{const h=r.getLoginStatus();i.push(h),h.then(L=>{this.setUser(L,c),s=!0}).catch(console.debug)}),Promise.all(i).catch(()=>{s||(this._user=null,this._authState.next(null))})}this.providers.forEach((i,s)=>{(0,x.b)(i.changeUser)&&i.changeUser.subscribe(r=>{this._ngZone.run(()=>{this.setUser(r,s)})})})}).catch(i=>{t(i)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}getAccessToken(e){var t=this;return(0,P.Z)(function*(){const i=t.providers.get(e);if(!t.initialized)throw n.ERR_NOT_INITIALIZED;if(!i)throw n.ERR_LOGIN_PROVIDER_NOT_FOUND;if(!(i instanceof d))throw n.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN;return yield i.getAccessToken()})()}refreshAuthToken(e){return new Promise((t,i)=>{if(this.initialized){const s=this.providers.get(e);s?"function"!=typeof s.refreshToken?i(n.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN):s.refreshToken().then(r=>{this.setUser(r,e),t()}).catch(r=>{i(r)}):i(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(n.ERR_NOT_INITIALIZED)})}refreshAccessToken(e){return new Promise((t,i)=>{if(this.initialized)if(e!==d.PROVIDER_ID)i(n.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{const s=this.providers.get(e);s instanceof d?s.revokeAccessToken().then(t).catch(i):i(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(n.ERR_NOT_INITIALIZED)})}signIn(e,t){return new Promise((i,s)=>{if(this.initialized){let r=this.providers.get(e);r?r.signIn(t).then(c=>{this.setUser(c,e),i(c)}).catch(c=>{s(c)}):s(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else s(n.ERR_NOT_INITIALIZED)})}signOut(e=!1){return new Promise((t,i)=>{if(this.initialized)if(this._user){let r=this.providers.get(this._user.provider);r?r.signOut(e).then(()=>{t(),this.setUser(null)}).catch(c=>{i(c)}):i(n.ERR_LOGIN_PROVIDER_NOT_FOUND)}else i(n.ERR_NOT_LOGGED_IN);else i(n.ERR_NOT_INITIALIZED)})}setUser(e,t){e&&t&&(e.provider=t),this._user=e,this._authState.next(e)}}return n.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",n.ERR_NOT_LOGGED_IN="Not logged in",n.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",n.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",n.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN="Chosen login provider is not supported for getting an access token",n.\u0275fac=function(e){return new(e||n)(o.LFG("SocialAuthServiceConfig"),o.LFG(o.R0b),o.LFG(o.zs3))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),j=(()=>{class n{constructor(e,t,i,s){this.router=void 0,this._ngZone=void 0,this.authenticationService=void 0,this.authService=void 0,this.onDestroy$=new m.x,this.router=e,this._ngZone=t,this.authenticationService=i,this.authService=s}ngOnInit(){window.onGoogleLibraryLoad=()=>{google.accounts.id.initialize({client_id:"267976867905-jk39h0f3jtlpjmtqmr79c2ehd5oq2dig.apps.googleusercontent.com",callback:this.handleCredentialResponse.bind(this),auto_select:!1,cancel_on_tap_outside:!0}),google.accounts.id.renderButton(document.getElementById("googleLoginButton"),{theme:"outline",size:"large",text:"continue_with"})}}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}handleCredentialResponse(e){this.authenticationService.googleLogin(e.credential).pipe((0,v.R)(this.onDestroy$)).subscribe(()=>{this._ngZone.run(()=>{this.router.navigate(["/"])})})}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(p.F0),o.Y36(o.R0b),o.Y36(g.$),o.Y36(b))},n.\u0275cmp=o.Xpm({type:n,selectors:[["pp-google-login"]],standalone:!0,features:[o._Bn([g.$,b,{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,providers:[{id:d.PROVIDER_ID,provider:new d("267976867905-jk39h0f3jtlpjmtqmr79c2ehd5oq2dig.apps.googleusercontent.com")}]}}]),o.jDz],decls:1,vars:0,consts:[["id","googleLoginButton"]],template:function(e,t){1&e&&o._UZ(0,"div",0)},dependencies:[O.ez,E.QW],styles:["[_nghost-%COMP%]{width:100%}"],changeDetection:0}),n})();function z(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"mat-icon",18),o.NdJ("click",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.togglePasswordVisibility())}),o._uU(1),o.qZA()}if(2&n){const e=o.oxw();o.xp6(1),o.hij(" ",e.passwordVisible?"visibility_off":"visibility"," ")}}const G=function(){return{required:"Wprowad\u017a adres e-mail",pattern:"Adres e-mail jest nieprawid\u0142owy",busy:"Podany adres e-mail jest ju\u017c u\u017cywany"}},Z=function(){return{required:"Wprowad\u017a has\u0142o",pattern:"Has\u0142o powinno zawiera\u0107 od 8 do 30 znak\xf3w, w tym jedna cyfra"}};let B=(()=>{class n{constructor(e,t){this.authenticationService=void 0,this.router=void 0,this.REGISTER_LINK=`/${y.G.AUTHENTICATION}/${y.G.REGISTER}`,this.onDestroy$=new m.x,this.form=new u.cw({email:new u.NI("",u.kI.compose([u.kI.required,u.kI.pattern(R.s)])),password:new u.NI("",u.kI.compose([u.kI.required,u.kI.pattern(R.l)]))},{updateOn:"change"}),this.passwordVisible=!1,this.authenticationService=e,this.router=t}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}login(){this.form.valid&&this.authenticationService.login(this.form.value).pipe((0,f.h)(e=>!!e),(0,D.b)(()=>this.router.navigate(["/"])),(0,v.R)(this.onDestroy$)).subscribe()}resandEmail(){this.form.get("email").valid&&this.authenticationService.resendEmail(this.form.get("email").value).pipe((0,f.h)(e=>!!e),(0,v.R)(this.onDestroy$)).subscribe()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(g.$),o.Y36(p.F0))},n.\u0275cmp=o.Xpm({type:n,selectors:[["pp-login"]],standalone:!0,features:[o._Bn([g.$]),o.jDz],decls:33,vars:8,consts:[[1,"content","fixWidth"],[1,"maxWidth"],[1,"box",3,"formGroup","ngSubmit"],[1,"login"],["label","login lub e-mail","placeholder","Wprowad\u017a adres e-mail","controlName","email",3,"ppErrorMessage"],["label","has\u0142o","placeholder","8-30 znak\xf3w, w tym cyfra","controlName","password",3,"type","suffixTemplate","ppErrorMessage"],[1,"get",2,"text-align","center"],["target","_blank",1,"text",2,"cursor","pointer",3,"click"],["type","submit",1,"button","button-login","cursor-pointer"],[1,"or"],[1,"line"],[1,"margin"],[1,"box","nextBox"],[1,"register","cursor-pointer",3,"routerLink"],[1,"box","remove"],[1,"regulamin","fixWidth"],["href","","target","_blank",1,"regulamin","link"],["suffixPassword",""],["matSuffix","",1,"cursor-pointer",3,"click"]],template:function(e,t){if(1&e&&(o.TgZ(0,"div",0)(1,"div",1)(2,"form",2),o.NdJ("ngSubmit",function(){return t.login()}),o.TgZ(3,"span",3),o._uU(4,"Zaloguj si\u0119"),o.qZA(),o._UZ(5,"pp-input",4)(6,"pp-input",5),o.TgZ(7,"div",6)(8,"a",7),o.NdJ("click",function(){return t.resandEmail()}),o._uU(9," Wy\u015blij ponownie e-mail z linkiem aktywacyjnym "),o.qZA()(),o.TgZ(10,"button",8),o._uU(11," ZALOGUJ SI\u0118 "),o.qZA(),o.TgZ(12,"div",9),o._UZ(13,"div",10),o.TgZ(14,"span"),o._uU(15,"lub"),o.qZA(),o._UZ(16,"div",10),o.qZA(),o._UZ(17,"pp-google-login",11),o.qZA(),o.TgZ(18,"div",12)(19,"b"),o._uU(20,"Nie masz konta?"),o.qZA(),o.TgZ(21,"span",13),o._uU(22," ZA\u0141\xd3\u017b KONTO "),o.qZA()()(),o._UZ(23,"div",14),o.qZA(),o.TgZ(24,"div",15),o._uU(25," Loguj\u0105c si\u0119 do ZmitaCart akceptujesz "),o.TgZ(26,"a",16),o._uU(27," Regulamin "),o.qZA(),o._uU(28," w aktualnym brzmieniu obowi\u0105zuj\u0105cym od dnia 29.02.1928. Informacje o planowanych oraz archiwalnych zmianach Regulaminu s\u0105 dost\u0119pne na "),o.TgZ(29,"a",16),o._uU(30," stronie "),o.qZA()(),o.YNc(31,z,2,1,"ng-template",null,17,o.W1O)),2&e){const i=o.MAs(32);o.xp6(2),o.Q6J("formGroup",t.form),o.xp6(3),o.Q6J("ppErrorMessage",o.DdM(6,G)),o.xp6(1),o.Q6J("type",t.passwordVisible?"text":"password")("suffixTemplate",i)("ppErrorMessage",o.DdM(7,Z)),o.xp6(15),o.Q6J("routerLink",t.REGISTER_LINK)}},dependencies:[O.ez,u.u5,u._Y,u.JL,k.a,u.UX,u.sg,I.Ps,I.Hw,p.Bz,p.rH,j],styles:["[_nghost-%COMP%]{background-color:var(--background-login-color);padding-top:16px;padding-bottom:24px;flex:1}.content[_ngcontent-%COMP%]{margin-inline:auto;display:flex;gap:var(--gap-m)}.fixWidth[_ngcontent-%COMP%]{padding-inline:30px;width:65%}@media (max-width: 1200px){.fixWidth[_ngcontent-%COMP%]{width:55%}}@media (max-width: 768px){.fixWidth[_ngcontent-%COMP%]{width:100%;margin:unset}}.regulamin[_ngcontent-%COMP%]{padding-top:8px;margin-inline:auto;font-size:var(--font-xs)}.regulamin[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{padding:0;color:var(--color-allegro-orange);text-decoration:none}.box[_ngcontent-%COMP%]{width:100%;min-width:400px;padding-inline:25px;padding-top:20px;padding-bottom:20px;display:flex;flex-direction:column;justify-content:center;align-items:center;background-color:#fff;transition:padding-top .2s ease,padding-bottom .2s ease,box-shadow .2s ease;box-shadow:0 2px 6px #0000001a}.nextBox[_ngcontent-%COMP%]{margin-top:20px;display:flex;flex-direction:row;justify-content:flex-start;gap:var(--gap-s);padding-block:10px}.register[_ngcontent-%COMP%]{color:var(--color-allegro-green);line-height:var(--lineHeight-xl);vertical-align:middle;letter-spacing:2px}.bold[_ngcontent-%COMP%]{font-weight:700}.button[_ngcontent-%COMP%]{width:100%;background-color:var(--color-allegro-orange);color:#fff;border:0;padding-inline:16px;height:40px}.button-bottom[_ngcontent-%COMP%]{background-color:#fff;color:#222;border:1px solid #aaa;margin-bottom:15px;position:relative;display:flex;justify-content:center;align-items:center}.img[_ngcontent-%COMP%]{position:absolute;left:8px}.margin[_ngcontent-%COMP%]{margin-bottom:15px;display:flex;justify-content:center;width:100%}.get[_ngcontent-%COMP%]{width:100%;margin-top:24px;margin-bottom:16px}.get[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:var(--color-allegro-green);text-decoration:none!important}.line[_ngcontent-%COMP%]{width:100%;border-bottom:1px solid #ddd}.or[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:var(--gap-xs);width:100%;padding-block:12px}.login[_ngcontent-%COMP%]{font-size:var(--font-l);font-weight:500;color:#222;margin-bottom:14px;font-family:Roboto;width:100%}@media (max-width: 1200px){.remove[_ngcontent-%COMP%]{display:none}}"],changeDetection:0}),n})()}}]);